{% comment %}
  FAQ section: This is a FAQ section, where each FAQ item is a block. Clicking an item should expand the block, showing the answer below the question.
{% endcomment %}

<style>
  .faq {
    width: 100%;
    margin: 0 auto;
  }
  
  .section-{{ section.id }} {
    color: {{ section.settings.text_color }};
    background-color: {{ section.settings.background_color }};
  }
  
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
  
  .faq__title {
    text-align: center;
    margin-bottom: 40px;
    color: {{ section.settings.question_color }};
  }
  
  .faq__wrapper {
    width: 100%;
  }
  
  .faq__grid {
    display: flex;
    flex-wrap: wrap;
    border-top: 1px solid {{ section.settings.border_color }};
    border-left: 1px solid {{ section.settings.border_color }};
  }
  
  .section-{{ section.id }} .faq__grid-item {
    width: 100%;
    padding: 0;
    border-right: 1px solid {{ section.settings.border_color }};
    border-bottom: 1px solid {{ section.settings.border_color }};
    box-sizing: border-box;
  }
  
  .faq__item {
    width: 100%;
  }
  
  .faq__question-wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 40px 66px;
    cursor: pointer;
    list-style: none;
  }
  
  .section-{{ section.id }} .faq__question {
    color: {{ section.settings.question_color }};
    font-weight: normal;
    margin: 0;
    width: 85%;
  }
  
  .section-{{ section.id }} .faq__toggle-icon {
    position: relative;
    width: 54px;
    height: 54px;
    border-radius: 50%;
    border: 1px solid {{ section.settings.border_color }};
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
  }
  
  .section-{{ section.id }} .faq__toggle-icon:hover {
    opacity: 0.8;
  }
  
  .section-{{ section.id }} .icon-plus, .section-{{ section.id }} .icon-minus {
    position: absolute;
    transition: opacity 0.3s ease;
    color: {{ section.settings.icon_color }};
  }
  
  .section-{{ section.id }} .icon-minus {
    opacity: 0;
  }
  
  .section-{{ section.id }} details[open] .icon-plus {
    opacity: 0;
  }
  
  .section-{{ section.id }} details[open] .icon-minus {
    opacity: 1;
  }
  
  .section-{{ section.id }} .faq__answer {
    color: {{ section.settings.text_color }};
    padding: 0 66px 40px 66px;
    width: 85%;
    max-width: 588px;
  }
  
  @media screen and (min-width: 750px) {
    .section-{{ section.id }} .faq__grid-item {
      width: 50%;
    }
  }
</style>

<div class="faq section-{{ section.id }} section-{{ section.id }}-padding" id="Faq-{{ section.id }}" {{ section.shopify_attributes }}>
  {% if section.settings.title != blank %}
    <h2 class="faq__title">{{ section.settings.title }}</h2>
  {% endif %}
  
  <div class="faq__wrapper">
    <div class="faq__grid">
      {%- for block in section.blocks -%}
        {% case block.type %}
          {% when 'faq' %}
            <div class="faq__grid-item" {{ block.shopify_attributes }}>
              <details class="faq__item" id="FAQ-{{ block.id }}">
                <summary class="faq__question-wrapper">
                  <h3 class="faq__question">{{ block.settings.question }}</h3>
                  <div class="faq__toggle-icon">
                    <span class="icon-plus">+</span>
                    <span class="icon-minus">-</span>
                  </div>
                </summary>
                <div class="faq__answer">{{ block.settings.answer }}</div>
              </details>
            </div>
        {% endcase %}
      {%- endfor -%}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const details = document.querySelectorAll('#Faq-{{ section.id }} details');
    
    details.forEach(detail => {
      detail.addEventListener('click', (e) => {
        // Only run if the click is directly on the summary element or one of its children
        if (e.target.closest('summary')) {
          // Close all other details when one is opened
          if (!detail.hasAttribute('open')) {
            details.forEach(otherDetail => {
              if (otherDetail !== detail && otherDetail.hasAttribute('open')) {
                otherDetail.removeAttribute('open');
              }
            });
          }
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "FAQ",
  "tag": "section",
  "class": "section section-faq",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#42302C"
    },
    {
      "type": "color",
      "id": "question_color", 
      "label": "Question color",
      "default": "#9E5048"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#E0D4C8"
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Icon color",
      "default": "#9E5048"
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 60
    }
  ],
  "blocks": [
    {
      "type": "faq",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Frequently asked question"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Use this text to answer questions in as much detail as possible for your customers.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQs",
      "blocks": [
        {
          "type": "faq",
          "settings": {
            "question": "Is this program really going to work, even if I don't get facials?",
            "answer": "<p>For most cases, yes. Over the years we've had dozens of clients use our online resources, use our products and clear their acne on their own. However, some clients did need some professional help. We are happy to help assist you in finding someone local, to administer chemical peels, extractions and support alongside the skinSALVATION program. Additionally, we're always available in case questions that aren't covered on our site come up, so take advantage and contact us if need be.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "How long will it take me to get my products?",
            "answer": "<p>Our products typically ship within 1-2 business days. Delivery times depend on your location, but most orders arrive within 3-5 business days after shipping.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "What makes skinSALVATION different?",
            "answer": "<p>We focus exclusively on acne treatment with a holistic approach. Our products are formulated specifically for acne-prone skin, and our program addresses lifestyle factors, diet, and skincare routines to provide a comprehensive solution.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "How can I become a skinSALVATION client?",
            "answer": "<p>Simply purchase one of our starter kits or book a consultation through our website. We'll guide you through our process and create a personalized plan for your specific needs.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}