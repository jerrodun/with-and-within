{%- assign section_color = section.settings.color_scheme -%}
{%- assign font_size = 'font-size__basic' -%}
{%- comment -%}Global module padding option affecting all modules within this file.{%- endcomment -%}
{%- assign modules_padding = section.settings.general_page_padding -%}

{% assign section_padding_top_none = section.settings.section_padding_top_none %}
{% assign section_padding_bottom_none = section.settings.section_padding_bottom_none %}

{% if modules_padding == 'smaller' %}
  {% assign modules_padding = 'section-with-padding--smaller' %}
{% elsif modules_padding == 'larger' %}
  {% assign modules_padding = 'section-with-padding--larger' %}
{% else %}
  {% assign modules_padding = null %}
{% endif %}

<section class="cascade cascade-custom section-with-padding pb0 pt0 color--{{ section_color }}-text bg--{{ section_color }}-background overflow--hidden" data-section-type="cascade" data-section-id="{{ section.id }}" {% if settings.fade_in_items %}data-fade-in="true"{% endif %} data-first-item="left">

  {%- comment -%} Starting value with null since starting with false will break the logic{%- endcomment -%}
  {% assign is_cascading_content_active = nil %}
  {%- comment -%}Starting with -1 to offset the first module count ( not counting the first module since that just tells shopify that a cascading section is starting ) {%- endcomment -%}
  {% assign cascading_items_counter = -1 %}

  {%- for block in section.blocks -%}


  {% if block.settings.section_bg_color %}
    {% assign bg_color_class = "aw-bg--" | append: block.settings.section_bg_color %}
  {% else %}
    {% assign bg_color_class = "" %}
  {% endif %}

  {% if block.settings.section_custom_padding %}
    {% if block.settings.section_custom_padding == 'smaller' %}
      {% assign section_custom_padding = "section-with-padding--smaller" %}
    {% elsif block.settings.section_custom_padding == 'larger' %}
      {% assign section_custom_padding = "section-with-padding--larger" %}
    {% endif %}
  {% endif %}

  {% if block.settings.section_padding_top_none %}
    {% assign padding_top_class = 'pt0' %}
  {% else %}
    {% assign padding_top_class = '' %}
  {% endif %}

  {% if block.settings.section_padding_bottom_none %}
    {% assign padding_bottom_class = 'pb0' %}
  {% else %}
    {% assign padding_bottom_class = '' %}
  {% endif %}

  {% if is_cascading_content_active == true and cascading_items_counter == 0 %}
    {% assign is_first_column = true %}
  {% else %}
    {% assign is_first_column = false %}
  {% endif %}

  {% if block.type == 'start_cascading_section' %}

  {% assign is_cascading_content_active = true %}
  <div class="cascade cascade-section-bg full {{ bg_color_class }} relative" data-section-type="cascade" data-section-id="{{ block.id }}" data-first-item="">

    {% if block.settings.section_bg_color == 'gradient' %}
    <div class="aw-bg-gradient-opacity-absolute-element"></div>
    {% endif %}

  <div class="max-site-width px2 lg--up--px3 section-with-padding {{ modules_padding }} {{ section_custom_padding }} {{ padding_top_class }} {{ padding_bottom_class }} relative">
  <div class="cascading-content" data-section-type="cascade" data-section-id="{{ block.id }}" data-first-item="left">


    <div class="items overflow--hidden">
      <div class="item-sizer"></div>
      <div class="column-sizer"></div>

      {%- assign col_count_desktop = '' -%}
      {%- assign col_count_mobile = '' -%}

      {% elsif is_cascading_content_active != true %}

      {% if block.type != "product_checker" %}
        {% assign should_relative_position = 'relative' %}
      {% else %}
        {% assign should_relative_position = '' %}
      {% endif %}

      <div class="cascade-section-bg {{ block.type | replace: '_', '-' }} full {{ bg_color_class }} relative">
        {% if block.settings.section_bg_color == 'gradient' %}
        <div class="aw-bg-gradient-opacity-absolute-element"></div>
        {% endif %}

      <div class="max-site-width px2 lg--up--px3 section-with-padding {{ modules_padding }} {{ section_custom_padding }} {{ padding_top_class }} {{ padding_bottom_class }} {{ should_relative_position }}">


 {% endif %}


  {% if is_cascading_content_active == true and cascading_items_counter >= 0 %}

      {%- assign first_col_desktop = false -%}
      {%- assign first_col_mobile = false -%}

      {% if block.settings.block_width_mobile != nil %}
        {%- assign block_width_mobile = block.settings.block_width_mobile -%}
      {% else %}
        {%- assign block_width_mobile = "half" -%}
      {% endif %}

      {% if block.settings.block_width != nil %}
        {%- assign block_width_desktop = block.settings.block_width -%}
      {% else %}
        {%- assign block_width_desktop = "half" -%}
      {% endif %}

      {%- if block.type == 'product_feature' or block.type == 'section_break' -%}
        {%- assign block_width_mobile = 'full' -%}
        {%- assign block_width_desktop = 'full' -%}
      {%- endif -%}


      {% comment %}
      First check if it's the first post of the loop and it isn't full width %}
      {% endcomment %}
      {%- if is_first_column and block_width_desktop == 'half' -%}
        {%- assign first_col_desktop = true -%}
        {%- assign col_count_desktop = 1 -%}
      {%- endif -%}

      {%- if is_first_column and block_width_mobile == 'half' -%}
        {%- assign first_col_mobile = true -%}
        {%- assign col_count_mobile = 1 -%}
      {%- endif -%}

      {% comment %}
      Now check to see if last block is full width, and this block isn't.
      {% endcomment %}
      {%- if last_block_width_desktop == 'full' and block_width_desktop == 'half' -%}
        {%- assign first_col_desktop = true -%}
        {%- assign col_count_desktop = 1 -%}
      {%- endif -%}

      {%- if last_block_width_mobile == 'full' and block_width_mobile == 'half' -%}
        {%- assign first_col_mobile = true -%}
        {%- assign col_count_mobile = 1 -%}
      {%- endif -%}


      {% comment %}
      Assign class for last item
      {% endcomment %}
      {%- if forloop.last -%}
        {%- assign last_col = true -%}
      {%- endif -%}

      <div
      class="item {% if block.type == 'section_break' %}item--section-break{% endif %} item--desktop--{{ block_width_desktop }} item--mobile--{{ block_width_mobile }} item--{{ block.id }} {% if is_first_column %}item--first{% endif %} {% if first_col_desktop %}first-col--desktop{% endif %} {% if first_col_mobile %}first-col--mobile{% endif %} {% if last_col %}item--last{% endif %} {% if settings.fade_in_items %}fade-in{% endif %}"
      data-width="{{ block_width_desktop }}"
      data-block-id="{{ block.id }}"
      >
      <div class="item__inner {% if block_width_mobile == 'full' %}five-sixths mx--auto{% endif %} {% if block_width_desktop == 'full' %}lg--up--five-sixths lg--up--mx--auto{% else %}lg--up--one-whole{% endif %}" {{ block.shopify_attributes }}>

  {% endif %}

    {% comment %}
    /* ============================================================================
      Image
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'image' %}
      {% if block.settings.url %}
        <a href="{{ block.settings.url }}" class="block">
      {% endif %}
      {% if block.settings.image %}
        {% assign image = block.settings.image %}
        {% assign image_ratio = block.settings.image.aspect_ratio  | plus: 0 %}
        <div class="image-holder {% if col_count_mobile == 2 or col_count_mobile == 3 %}seven-eighths mx--auto{% endif %} {% if col_count_desktop == 2 or col_count_desktop == 3 %}lg--up--five-sixths lg--up--mx--auto{% endif %}">
          {% render 'responsive-image' with
            image: image,
            max_width: 2000,
            max_height: 2000,
            section_color: section_color,
          %}
        </div>
      {% else %}
        <div class="onboarding-image">
          <div class="placeholder-img-wrapper bg--{{ section_color }}-placeholder">
            <div style="padding-top:{% cycle '66.6', '133.33', '100' %}%;" class="relative">
              {{ 'image' | placeholder_svg_tag }}
            </div>
          </div>
        </div>
      {% endif %}
      {% if block.settings.url %}
      </a>
      {% endif %}
    {% endif %}

    {% comment %}
    /* ============================================================================
      Image with Text
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'image_text_overlay' %}
      {% assign heading = block.settings.heading %}
      {% assign cta_text = block.settings.cta_text %}
      {% assign cta_url = block.settings.cta_url %}
      {% assign local_color = block.settings.section_color %}
      <div class="image-with-text__container relative  {% if col_count_mobile == 2 or col_count_mobile == 3 %}seven-eighths mx--auto{% endif %} {% if col_count_desktop == 2 or col_count_desktop == 3 %}lg--up--five-sixths lg--up--mx--auto{% endif %}">
        <div class="image-with-text__image">
          {% assign image = block.settings.image %}
          {% if image %}
            <div class="image-holder">
              {% render 'responsive-image' with
                image: image,
                max_width: 2000,
                max_height: 2000,
                section_color: section_color
              %}
            </div>
          {% else %}
            <div class="onboarding-image bg--{{ section_color }}-placeholder color--border">
              <span class="opacity--1">{{ 'image' | placeholder_svg_tag }}</span>
            </div>
          {% endif %}
        </div>
        <div class="image-with-text__content absolute full top--0 left--0 p1 z1">
          {% if cta_url != blank %}
          <a href="{{ cta_url }}" class="block full color--{{ section_color }}-text">
          {% endif %}
            <div class="table full">
              <div class="table-cell text-align--center align--middle">
                <div class="inline-block  align--middle">
                  {% if block_width_mobile == 'full' %}
                    {% assign heading_class = 'font-size__heading-mobile-full' %}
                  {% else %}
                    {% assign heading_class = 'font-size__heading-mobile-half' %}
                  {% endif %}
                  {% if heading != blank %}
                  <h2 class=" m0 {{ heading_class }} color--{{ local_color }}-text">{{ heading }}</h2>
                  {% endif %}
                  {% if cta_text != blank %}
                    <p class="{% if block_width_mobile == 'half' %}sm--hide{% endif %} m0 lg--up--mt1 inline-block {{ font_size }} link-underline f--accent color--{{ local_color }}-text border-bottom--{{ local_color }}-text hv--{{ local_color }}-accent hv--border-bottom--{{ local_color }}-accent" href="" target="_blank" aria-label="link - new window">
                      {{ cta_text }}
                    </p>
                  {% endif %}
                </div>
              </div>
            </div>
          {% if cta_url != blank %}
          </a>
          {% endif %}

        </div>
      </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Video
    ============================================================================== *
    {% endcomment %}
    {% if block.type == 'video' %}
      <div class="video-holder {% if col_count_mobile == 2 or col_count_mobile == 3 %}seven-eighths mx--auto{% endif %} {% if col_count_desktop == 2 or col_count_desktop == 3 %}lg--up--five-sixths lg--up--mx--auto{% endif %}">
        {% if block.settings.video_url %}
          {% if block.settings.video_url.type == 'youtube' %}
            {% capture image_url_mq %}//img.youtube.com/vi/{{ block.settings.video_url.id }}/mqdefault.jpg{% endcapture %}
            {% if block.settings.use_high_res_image %}
            {% capture image_url_max %}//img.youtube.com/vi/{{ block.settings.video_url.id }}/maxresdefault.jpg{% endcapture %}
            {% else %}
            {% capture image_url_max %}//img.youtube.com/vi/{{ block.settings.video_url.id }}/hqdefault.jpg{% endcapture %}
            {% endif %}
            <div class="responsive-image__wrapper js">
              <div style="padding-top: 56.25%;">
                <img
                     class="responsive-image__image lazyload"
                     data-srcset="{{ image_url_mq }} 320w,
                                  {{ image_url_max }}"
                     data-sizes="auto"
                     >
              </div>
              <a href="//www.youtube.com/embed/{{ block.settings.video_url.id }}?autoplay=1&showinfo=0&controls=1" class="absolute top--0 left--0 full pointer modaal z1" data-modaal-type="video">
                <div class="full flex items--center justify--center color--white-text font-size--xl md--up--font-size--xxl lg--up--font-size--xxxxxl">
                  {% render 'icon-play' %}
                </div>
              </a>
            </div>
            <noscript>
              <img src="{{ image_url_max }}">
            </noscript>
          {% endif %}
          {% if block.settings.video_url.type == 'vimeo' %}
            <div class="responsive-image__wrapper  js">
              <div style="padding-top: 56.25%;">
                <img
                     class="responsive-image__image vimeo-thumbnail"
                     data-src=""
                     data-widths="[540, 720, 900, 1080, 1296, 1512, 1728, 1944, 2048, 4472]"
                     data-aspectratio="{{ image.aspect_ratio }}"
                     data-sizes="auto"
                     data-vimeo-id='{{ block.settings.video_url.id }}'
                     data-vimeo-thumb
                     >
              </div>
              <a href="//player.vimeo.com/video/{{ block.settings.video_url.id }}?autoplay=1%color={{ settings.color_primary }}&title=0&byline=0" class="absolute top--0 left--0 full pointer modaal z1" data-modaal-type="video">
                <div class="full flex items--center justify--center color--white-text font-size--xl md--up--font-size--xxl lg--up--font-size--xxxxxl">
                  {% render 'icon-play' %}
                </div>
              </a>
            </div>
          {% endif %}
        {% else %}
          <div class="responsive-image__wrapper  js">
            <div style="padding-top: 56.25%;">
             <div class="placeholder-img-wrapper bg--{{ section_color }}-placeholder absolute top--0 right--0 left--0 bottom--0">
               <div style="padding-top:56.25%;" class="relative">
                  {{ 'lifestyle-1' | placeholder_svg_tag }}
               </div>
             </div>
            </div>
            <a class="absolute top--0 left--0 full pointer z1">
              <div class="full flex items--center justify--center color--white font-size--xl md--up--font-size--xxl lg--up--font-size--xxxxxl">
                {% render 'icon-play' %}
              </div>
            </a>
          </div>
          <noscript>
            <img src="{{ image_url_max }}">
          </noscript>
        {% endif %}
      </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Rich Text
    ============================================================================== *
    {% endcomment %}
    {% if block.type == 'rich_text' or block.type == 'heading' or block.type == 'text' %}
    {% assign heading_text_color = block.settings.heading_text_color %}
    <div class="rich-text rich-text--{{ block.id }} {{ block.settings.text_align }}">
      {% if block.settings.text_align == 'text-align--center' %}
        {% assign text_align_related_class = 'mx--auto' %}
      {% else %}
        {% assign text_align_related_class = '' %}
      {% endif %}
      {% if block.type == 'heading' %}
      <div class="seven-eighths pm--three-quarters wd--one-twelveth {{ text_align_related_class }}">
      {% else %}
      <div class="seven-eighths mx--auto pm--three-quarters wd--two-thirds">
      {% endif %}
        {% if block.settings.heading != blank   %}
          {% if block_width_mobile == 'full' %}
            {% assign heading_class = 'font-size__heading-mobile-full' %}
          {% else %}
            {% assign heading_class = 'font-size__heading-mobile-half' %}
          {% endif %}
          {% if block.type == 'heading' and block.settings.font_size == 'large' %}
            {% if block_width_mobile == 'full' %}
              {% assign heading_class = 'f--heading font-size--xxxl line-height--8 pm--font-size--xxxxxl md--up--font-size--xxxxxl pm--line-height--11 wd--font-size--xxxxxxl wd--line-height--13' %}
            {% else %}
              {% assign heading_class = 'f--heading font-size--xxl line-height--7 pm--font-size--xxxxl  md--up--font-size--xxxxxl pm--line-height--11 wd--font-size--xxxxxxl wd--line-height--13' %}
            {% endif %}
          {% endif %}
          <h2 class=" m0 {{ heading_class }} {{ heading_text_color }}">
            {{ block.settings.heading }}
          </h2>
          <div class="richtext font-size__basic mt2">
            {{ block.settings.subtext}}
          </div>
        {% endif %}
        {% if block.settings.rich_text != blank  %}
        <div class="richtext {{ font_size }} {% if block.settings.heading != blank %}mt2{% endif %}">
          {{ block.settings.rich_text }}
        </div>
        {% endif %}
        {% if block.settings.cta_url != blank %}
        <a class="inline-block homepage-more-link  {{ font_size }}  f--accent link-underline--{{ section_color }} hover-underline--{{ section_color }}" href="{{ block.settings.cta_url }}" >
          {{ block.settings.cta_text }}
        </a>
        {% endif %}
      </div>
    </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Custom HTML
    ============================================================================== *
    {% endcomment %}
    {% if block.type == 'custom_html' %}
    <div class="custom-html custom-html--{{ block.id }}">
      <div class="seven-eighths mx--auto pm--three-quarters wd--two-thirds">
        {% if block.settings.html != blank  %}
        <div">
          {{ block.settings.html }}
        </div>
        {% endif %}

      </div>
    </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Collection
    ============================================================================== *
    {% endcomment %}
    {% if block.type == 'collection' %}
      {% assign local_color = block.settings.text_color %}
      {% if block.settings.collection and block.settings.collection != '' %}
        {% assign collection = collections[block.settings.collection] %}
        {% if collection.image %}
          {% assign image = collection.image  %}
        {% else %}
          {% for product in collection.products limit:1 %}
            {% assign image = product.featured_image.src  %}
          {% endfor %}
        {% endif %}
        <div class="image-with-text__container relative  {% if col_count_mobile == 2 or col_count_mobile == 3 %}seven-eighths mx--auto{% endif %} {% if col_count_desktop == 2 or col_count_desktop == 3 %}lg--up--five-sixths lg--up--mx--auto{% endif %}">
          <div class="image-with-text__image">

            {% assign image_ratio = block.settings.image.aspect_ratio  | plus: 0 %}
            <div class="image-holder">
              {% render 'responsive-image' with
                image: image,
                max_width: 2000,
                max_height: 2000,
                section_color: section_color
              %}
            </div>
          </div>
          <div class="image-with-text__content absolute full top--0 left--0 p1 z1">
            <a href="{{ collection.url }}" class="block full">
              <div class="table full">
                <div class="table-cell text-align--center align--middle">
                  <div class="inline-block  align--middle">
                    {% if block_width_mobile == 'full' %}
                      {% assign heading_class = 'font-size__heading-mobile-full' %}
                    {% else %}
                      {% assign heading_class = 'font-size__heading-mobile-half' %}
                    {% endif %}
                    <h2 class=" m0 {{ heading_class }} color--{{ local_color }}-text">{{ collection.title }}</h2>
                    {% if block.settings.show_collection_link %}
                      <p class="{% if block_width_mobile == 'half' %}sm--hide{% endif %} m0 lg--up--mt1 inline-block {{ font_size }} link-underline f--accent color--{{ local_color }}-text border-bottom--{{ local_color }}-text hv--{{ local_color }}-accent hv--border-bottom--{{ local_color }}-accent" href="" target="_blank" aria-label="link - new window">
                        {{ block.settings.cta_text }}
                      </p>
                    {% endif %}
                  </div>
                </div>
              </div>
            </a>
          </div>
        </div>
      {% else %}
        {%- render 'cascade__collection-placeholder',
                    local_color: local_color,
                    section_color: section_color,
                    text_position: 'over',
                    block_width_mobile: block.settings.block_width_mobile,
        -%}
      {% endif %}
    {% endif %}


    {% comment %}
    /* ============================================================================
      Article
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'article' %}
      {% assign local_color = block.settings.text_color %}
      {% if block.settings.article and block.settings.article != '' %}
        {% assign article = articles[block.settings.article] %}
        <div class="grid">
          <div class="grid__item {% if block_width_desktop == 'full' %}lg--up--four-sevenths{% endif %}">
            <a href="{{ article.url  }}">
            {% if article.image %}
              {% assign image = article.image %}
              <div class="image-holder">
                {% render 'responsive-image' with
                  image: image,
                  max_width: 2000,
                  max_height: 2000,
                  section_color: section_color
                %}
              </div>
            {% endif %}
            </a>
          </div>
          <div class="grid__item {% if block_width_desktop == 'full' %}lg--up--three-sevenths lg--up--pt3{% endif %}">
            <div class="seven-eighths pm--three-quarters {% if settings.list_and_grid_align %}mx--auto{% else %}pl1 lg--up--pl2 {% endif %} t--list-and-grid">
              <a href="{{ article.url  }}"  class="color--{{ section_color }}-text">

                {% if block_width_mobile == 'full' %}
                  {% assign heading_class = 'font-size__heading-mobile-full' %}
                {% else %}
                  {% assign heading_class = 'font-size__heading-mobile-half' %}
                {% endif %}
                <h2 class=" m0 {{ heading_class }} {% if article.image %}mt2 pm--mt3{% endif %}">
                  {{ article.title }}
                </h2>

                <div class="mt1 lg--up--mt2 {{ font_size }}">
                  {% if block.settings.show_excerpt %}
                  {% if article.excerpt.size > 0 %}
                    {{ article.excerpt }}
                  {% else %}
                    {{ article.content | strip_html | truncatewords: 20 }}
                  {% endif %}
                  {% endif %}
                </div>

                <p class="mt1 lg--up--mt2 inline-block {{ font_size }} f--accent link-underline--{{ section_color }} hover-underline--{{ section_color }}" target="_blank" aria-label="link - new window">
                  {{ 'blogs.article.read_more' | t }}
                </p>

              </a>
            </div>
          </div>
        </div>
      {% else %}
        {%- render 'cascade__article-placeholder',
                    block_width_desktop: block_width_desktop,
                    section_color: section_color,
        -%}
      {% endif %}
    {% endif %}


    {% comment %}
    /* ============================================================================
      Product - Simple
    ============================================================================== *
    {% endcomment %}
    {% if block.type == 'product_simple' %}
    <div class="product product--{{ block.id }} {% if col_count_mobile == 2 or col_count_mobile == 3 %}seven-eighths mx--auto{% endif %} {% if col_count_desktop == 2 or col_count_desktop == 3 %}lg--up--five-sixths lg--up--mx--auto{% endif %}">
      {%- assign product = all_products[block.settings.product] -%}
      {% if product == empty %}
        {%- render 'product-grid-item__onboarding',
                    section_color: section_color,
        -%}
      {% else %}
        {% assign feature_product = true %}
        {%- render 'product-grid-item',
            product: product,
            section_color: section_color,
            feature_product: feature_product,
        -%}
      {% endif %}
    </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Product - Feature
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'product_feature' %}
    <div class="product product--{{ block.id }}">
      {%- assign product = all_products[block.settings.product] -%}
      {%- assign current_variant = product.selected_or_first_available_variant -%}
      {%- assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media -%}
      {%- assign hide_drop_down_labels = block.settings.hide_drop_down_labels -%}
      {%- assign show_quantity = block.settings.show_quantity -%}
      {%- assign enable_payment_button = block.settings.enable_payment_button -%}
      {%- assign enable_video_looping = block.settings.enable_video_looping %}
      {%- assign section_id = block.id -%}
      {% capture module_id %}section-{{ section.id }}-block-{{ block.id }}-{{ product.id }}{% endcapture %}

      <section data-module-id="{{ module_id }}" data-product-block data-product-feature="true">
        {% assign feature_product = true %}
        {% if product == empty %}
          {%- render 'product__onboarding',
              block: block,
              section_color: section_color
          -%}
        {% else %}
          {% assign section_id = block.id %}
          {%- render 'product__top-section',
              product: product,
              feature_product: feature_product,
              current_variant: current_variant,
              featured_media: featured_media,
              hide_drop_down_labels: hide_drop_down_labels,
              show_quantity: show_quantity,
              enable_payment_button: enable_payment_button,
              enable_video_looping: enable_video_looping,
              module_id: module_id,
              section_color: section_color,
              inside_cascade_section: true
          -%}
          <script type="application/json" data-product-json>
            {{ product | json }}
          </script>
          <script type="application/json" id="ModelJson-{{ block.id }}">
            {{ product.media | where: 'media_type', 'model' | json }}
          </script>
          <script type="application/ld+json">
          {
            "@context": "http://schema.org/",
            "@type": "Product",
            "name": {{ product.title | json }},
            "url": {{ shop.url | append: product.url | json }},
            {%- if product.featured_media -%}
              {%- assign media_size = product.featured_media.preview_image.width | append: 'x' -%}
              "image": [
                {{ product.featured_media | img_url: media_size | prepend: "https:" | json }}
              ],
            {%- endif -%}
            "description": {{ product.description | strip_html | json }},
            {%- if current_variant.sku != blank -%}
              "sku": {{ current_variant.sku | json }},
            {%- endif -%}
            "brand": {
              "@type": "Thing",
              "name": {{ product.vendor | json }}
            },
            "offers": [
              {%- for variant in product.variants -%}
                {
                  "@type" : "Offer",
                  {%- if variant.sku != blank -%}
                    "sku": {{ variant.sku | json }},
                  {%- endif -%}
                  "availability" : "http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
                  "price" : {{ variant.price | divided_by: 100.00 | json }},
                  "priceCurrency" : {{ cart.currency.iso_code | json }},
                  "url" : {{ shop.url | append: variant.url | json }}
                }{% unless forloop.last %},{% endunless %}
              {%- endfor -%}
            ]
          }
          </script>
        {% endif %}
      </section>
    </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Image with text & buttons
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'block_img_text_buttons' %}

    {%- assign section_color = block.settings.color_scheme -%}

    {%- assign should_swap_column_order = block.settings.should_swap_column_order -%}

    {%- assign heading = block.settings.heading -%}
    {%- assign heading_font_size = block.settings.heading_font_size -%}
    {%- assign overline_heading = block.settings.overline_heading -%}
    {%- assign heading_text_color = block.settings.heading_text_color -%}
    {%- assign show_heading_under_image = block.settings.show_heading_under_image -%}

    {%- assign heading_secondary = block.settings.heading_secondary -%}
    {%- assign text_secondary = block.settings.text_secondary | replace: '--listStart--', '<div class="list-wrapper">' | replace: '--listEnd--', '</div>' -%}

    {%- assign text = block.settings.text | replace: '--listStart--', '<div class="list-wrapper">' | replace: '--listEnd--', '</div>' -%}
    {%- assign buttons_top_spacing = block.settings.buttons_top_spacing -%}
    {%- assign buttons_style_type = block.settings.buttons_style_type -%}
    {%- assign button1_text = block.settings.button1_text -%}
    {%- assign button1_url = block.settings.button1_url -%}
    {%- assign button2_text = block.settings.button2_text -%}
    {%- assign button2_url = block.settings.button2_url -%}
    {%- assign feature_image = block.settings.feature_image -%}
    {%- assign bottom_image = block.settings.bottom_image -%}

    {% if should_swap_column_order  %}
      {% assign swap_col_order_class = 'image-text-buttons--col-swapped' %}
    {% else %}
      {% assign swap_col_order_class = '' %}
    {% endif %}

    <div class="image-text-buttons color--{{ section_color }}-text lg--up--color--{{ text_color_overlay }}-text {% if gradient_bg %}bg--gradient{% endif %} data-section-type="newsletter" data-section-id="{{ section.id }}">
      <div class="grid--full flex flex--column md--up--flex--row {{ swap_col_order_class }}">
        <div class="image-text-buttons--col one-whole md--up--one-half">
          <div class="image-text-buttons__image relative">
            {% if block.settings.feature_image  %}
              {% render 'responsive-image' with
                image: feature_image,
                max_width: 619,
                max_height: 684,
                section_color: section_color,
              %}
            {% endif %}
          </div>

        {% if show_heading_under_image %}

          <div class="mt1 image-text-buttons__text image-text-buttons__text--under-image">

            {% if heading_secondary != blank %}
            <h2 class="image-text-buttons__text--heading image-text-buttons__text--heading-{{ heading_font_size }} image-text-buttons__text--heading-color--sky_blue m0 color--{{ section_color }}-meta">{{ heading_secondary }}</h2>
            {% endif %}

            {% if text_secondary != blank %}
              <div class="richtext font-size__basic aw-text--navy mt2">
                {{ text_secondary }}
              </div>
            {% endif %}
          </div>

        {% endif %}

        </div>

        <div class="image-text-buttons--col one-whole md--up--one-half mt3 md--up--mt0">

            <div class="image-text-buttons__container">

              <div class="mt1 image-text-buttons__text scroll-trigger">


                {% if heading != blank %}
                  <h2 class="image-text-buttons__text--heading image-text-buttons__text--heading-{{ heading_font_size }} image-text-buttons__text--heading-color-{{ heading_text_color }} m0 color--{{ section_color }}-meta">{{ heading }}</h2>
                {% endif %}
                {% if text != blank %}
                  <div class="richtext font-size__basic mt3">
                    {{ text }}
                  </div>
                {% endif %}
                
                {% if block.settings.html != blank %}
                  {{ block.settings.html }}
                {% endif %}

                {% if overline_heading != "" %}
                  <p class="image-text-buttons__overline-heading">{{ overline_heading }}</p>
                {% endif %}
              </div>

              {% if button1_url != blank or button2_url != blank %}

              <div class="image-text-buttons_buttons {{ buttons_top_spacing }}">
                {% if button1_url != blank %}

                  {% if button1_url contains "#product-checker" %}
                    {% assign button1_url = 'javascript:void' %}
                    <script>
                      document.addEventListener('DOMContentLoaded', function () {
                        let productCheckerSection = document.querySelector('.cascade-section-bg.product-checker');
                        let btnScrollIntoView = document.querySelector('a[product-checker-scroll-into-view]');
                        console.log(productCheckerSection);
                        btnScrollIntoView.addEventListener('click', function() {
                          productCheckerSection.scrollIntoView({behavior: 'smooth'});
                        });
                      });
                    </script>
                    {% capture productCheckerOnClick %}
                      product-checker-scroll-into-view
                    {% endcapture %}
                  {% endif %}

                  <a class="inline-block font-size__basic f--accent aw-btn--{{ buttons_style_type }}" {{ productCheckerOnClick }} href="{{ button1_url }}">
                    {{ button1_text }}
                  </a>
                {% endif %}
                {% if button2_url != blank %}
                  <a class="inline-block font-size__basic f--accent aw-btn--{{ buttons_style_type }}" href="{{ button2_url }}">
                    {{ button2_text }}
                  </a>
                {% endif %}
              </div>

              {% endif %}

            </div>

          {% if block.settings.bottom_image  %}
            <div class="image-text-buttons__bottom-image mt2">
              {% render 'responsive-image' with
                image: bottom_image,
                max_width: 516,
                max_height: 215,
                section_color: section_color,
              %}
            </div>
          {% endif %}

        </div>

      </div>
    </div>

    {% endif %}


    {% comment %}
    /* ============================================================================
      Before & After Img + Text
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'before_after_img_text' %}

    {%- assign section_color = block.settings.color_scheme -%}
    {%- assign should_swap_column_order = block.settings.should_swap_column_order -%}

    {%- assign heading = block.settings.heading -%}
    {%- assign heading_font_size = block.settings.heading_font_size -%}
    {%- assign heading_text_color = block.settings.heading_text_color -%}

    {%- assign set_of_links = block.settings.set_of_links -%}
    {%- assign set_of_links_title = block.settings.set_of_links_title -%}
    {%- assign colored_text = block.settings.colored_text -%}
    {%- assign colored_text_title = block.settings.colored_text_title -%}

    {%- assign text = block.settings.text -%}
    {%- assign buttons_top_spacing = block.settings.buttons_top_spacing -%}
    {%- assign buttons_style_type = block.settings.buttons_style_type -%}
    {%- assign button1_text = block.settings.button1_text -%}
    {%- assign button1_url = block.settings.button1_url -%}
    {%- assign should_use_slider_for_photos = block.settings.should_use_slider_for_photos -%}
    {%- assign before_state_img = block.settings.before_img -%}
    {%- assign after_state_img = block.settings.after_img -%}
    {%- assign third_img = block.settings.third_img -%}

    {% render 'aw-before-and-after-img-text-snippet' with
        section_color: section_color,
        should_swap_column_order: should_swap_column_order,
        heading: heading,
        heading_font_size: heading_font_size,
        heading_text_color: heading_text_color,
        set_of_links: set_of_links,
        set_of_links_title: set_of_links_title,
        colored_text: colored_text,
        colored_text_title: colored_text_title,
        text: text,
        buttons_top_spacing: buttons_top_spacing,
        buttons_style_type: buttons_style_type,
        button1_text: button1_text,
        button1_url: button1_url,
        should_use_slider_for_photos: should_use_slider_for_photos,
        before_state_img: before_state_img,
        after_state_img: after_state_img,
        third_img: third_img
    %}


    {% endif %}

    {% comment %}
    /* ============================================================================
      Columns of Text
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'columns_of_text' %}

    {%- assign first_col_title = block.settings.first_col_title -%}
    {%- assign first_col_text = block.settings.first_col_text -%}
    {%- assign second_col_title = block.settings.second_col_title -%}
    {%- assign second_col_text = block.settings.second_col_text -%}
    {%- assign third_col_title = block.settings.third_col_title -%}
    {%- assign third_col_text = block.settings.third_col_text -%}
    {%- assign fourth_col_title = block.settings.fourth_col_title -%}
    {%- assign fourth_col_text = block.settings.fourth_col_text -%}

      <div class="full--w">

        <div class="grid--full grid-col-of-text">

          <div class="grid__item lg--up--one-quarter grid__item--col-of-text">
            <div class="col-of-text--wrapper">
              <div class="col-of-text__number-container">1.</div>
              <h2 class="col-of-text__heading">
                {{ first_col_title }}
              </h2>
              <p class="col-of-text__paragraph font-size__basic">
                {{ first_col_text }}
              </p>
            </div>
          </div>

          <div class="grid__item lg--up--one-quarter grid__item--col-of-text">
            <div class="col-of-text--wrapper">
              <div class="col-of-text__number-container">2.</div>
              <h2 class="col-of-text__heading">
                {{ second_col_title }}
              </h2>

              <p class="col-of-text__paragraph font-size__basic">
                {{ second_col_text }}
              </p>
            </div>
          </div>

          <div class="grid__item lg--up--one-quarter grid__item--col-of-text">
            <div class="col-of-text--wrapper">
              <div class="col-of-text__number-container">3.</div>

              <h2 class="col-of-text__heading">
                {{ third_col_title }}
              </h2>

              <p class="col-of-text__paragraph font-size__basic">
                {{ third_col_text }}
              </p>
            </div>

          </div>

          <div class="grid__item lg--up--one-quarter grid__item--col-of-text">
            <div class="col-of-text--wrapper">
              <div class="col-of-text__number-container">4.</div>

              <h2 class="col-of-text__heading">
                {{ fourth_col_title }}
              </h2>

              <p class="col-of-text__paragraph font-size__basic">
                {{ fourth_col_text }}
              </p>
            </div>
          </div>
        </div>
      </div> <!-- End of .f--width -->
    {% endif %}


    {% comment %}
    /* ============================================================================
      Testimonial
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'testimonial' %}

    <div class="testimonial color--{{ section_color }}-text" data-section-type="custom" data-section-id="{{ block.id }}">
              <div class="testimonial color--{{ section_color }}-text" data-section-type="custom" data-section-id="{{ block.id }}">
    <div class="testimonial color--{{ section_color }}-text" data-section-type="custom" data-section-id="{{ block.id }}">
      <div class="flex justify--center items--center">
        <div class="testimonial__container text-center">

          {% if block.settings.heading  %}
            <p class="testimonial__heading color--{{ section_color }}-meta">{{ block.settings.heading }}</p>
          {% endif %}

          {% if block.settings.quote != blank %}
            <div class="testimonial__quote">
              <p class="ml2 testimonial__quote--text">
                <span class="italic">"</span>{{ block.settings.quote }}<span class="italic">"</span>
              </p>

              {% if block.settings.author %}
                <p class="testimonial__quote--author text-uppercase">
                  - {{ block.settings.author }}
                </p>
              {% endif %}

            </div>
          {% endif %}

        </div>
      </div>
    </div>
    {% endif %}

    {% comment %}
    /* ============================================================================
      Featured Logos
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'featured_logos' %}

    {% assign block_settings = block.settings %}

    {%- comment -%} Assign Logo Icon Class if enabled{%- endcomment -%}
    {% assign show_icon_bg = block.settings.show_icon_bg %}
    {% if show_icon_bg %}
      {% assign icon_bg_class = 'bg--white' %}
    {% else %}
      {% assign icon_bg_class = "" %}
    {% endif %}

    {% render 'aw-featured-logos' with
        section_settings: block_settings %}

    {% endif %}

    {% comment %}
    /* ============================================================================
      Richtext
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'richtext' %}

    {%- comment -%}Full Width Option{%- endcomment -%}
    {% assign is_title_full_width = block.settings.is_title_full_width %}

    {% if is_title_full_width %}
      {% assign title_width_class = 'one-whole mb1 lg--up--mb3 ' %}
      {% assign grid_items_class = 'one-whole' %}
    {% else %}
      {% assign title_width_class = 'lg--up--one-quarter' %}
      {% assign grid_items_class = 'lg--up--three-quarters' %}
    {% endif %}

    {%- assign block_class = 'lg--up--one-third' -%}

    <div class="richtext aw-richtext-module color--{{ section_color }}-text" data-section-type="richtext" data-section-id="{{ block.id }}">

      <div class="grid">

        <div class="grid__item {{ title_width_class }}">
          <div class="pb3 pl2 pr4 lg--up--px0 lg--up--pb0">

            {% if block.settings.title  %}
              <h2 class="f--heading font-size__heading m0 {{ section_text_color }} line-height-120">{{ block.settings.title }}</h2>
            {% endif %} 

            {% if block.settings.show_first_cta %}
              <a class="inline-block aw-richtext-cta aw-btn--navy homepage-more-link  font-size__basic" href="{{ block.settings.cta_url }}" >
                {{ block.settings.cta_text }}
              </a>
            {% endif %}


          </div>
        </div>

        <div class="grid__item {{ grid_items_class }}">
          <div class="px2 lg--up--px0">
            <div class="grid mtn2 lg--up--mt0">
              {% for block in block.blocks %}
              <div class="grid__item mt2 lg--up--mt0 {% if block.blocks.size > 1 %}font-size__basic{% endif %} {{ block_class }}">
                {{ block.settings.richtext }}
                {% if forloop.last == true and block.settings.cta_url_after_text %}
                  <a class="inline-block aw-btn--text" href="{{ block.settings.cta_url_after_text }}" >
                    {{ block.settings.cta_text_after_text }}
                  </a>
                {% endif%}
              </div>
              {% endfor %}

              <div class="grid__item mt2 lg--up--mt0 font-size__basic {{ block_class }}">
                {{ block.settings.richtext_1 }}
              </div>

              <div class="grid__item mt2 lg--up--mt0 font-size__basic {{ block_class }}">
                {{ block.settings.richtext_2 }}
              </div>

              <div class="grid__item mt2 lg--up--mt0 font-size__basic {{ block_class }}">
                {{ block.settings.richtext_3 }}
                {% if forloop.last == true %}

                  {% if block.settings.cta_url_after_text %}
                    <a class="inline-block aw-btn--text" href="{{ block.settings.cta_url_after_text }}" >
                      {{ block.settings.cta_text_after_text }}
                    </a>
                  {% endif %}

                  {% if block.settings.cta_url_after_text_2 %}
                    <a class="inline-block aw-btn--text ml2" href="{{ block.settings.cta_url_after_text_2 }}" >
                      {{ block.settings.cta_text_after_text_2 }}
                    </a>
                  {% endif %}

                {% endif%}
              </div>

            </div>
          </div>
        </div>

      </div>
    </div>

    {% endif %}

    {% comment %}
    /* ============================================================================
      Image w/ Title & Text
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'image_title_text' %}

    {%- assign block_image = block.settings.block_image -%}
    {%- assign title = block.settings.title -%}
    {%- assign subtitle = block.settings.subtitle -%}
    {%- assign text = block.settings.text -%}


    <div class="img-title-text--wrapper">

        <div class="grid flex img-title-text--grid">

          <div class="grid__item lg--up--one-half">
              <div class="img-title-text--image">
                  {% render 'responsive-image' with
                      image: block_image,
                      max_width: 399,
                      max_height: 372,
                      section_color: section_color
                  %}
              </div>
          </div>

          <div class="grid__item lg--up--one-half">
              <div class="img-title-text--content">
                  <h2 class="img-title-text__title">
                      {{ title }}
                  </h2>
                  <h2 class="img-title-text__subtitle">
                      {{ subtitle }}
                  </h2>
                  <p class="img-title-text__text">
                      {{ text }}
                  </p>
              </div>
          </div>

        </div>
    </div>

    {% endif %}

    {% comment %}
    /* ============================================================================
      Map
    ============================================================================== *
    {% endcomment %}

    {% if block.type == 'map' %}

    {%- assign section_color = block.settings.color_scheme -%}


    {%- assign display_map = false -%}
    {%- assign onboarding = false -%}
    {%- assign use_image = false -%}
    {%- assign map_image = block.settings.map_image -%}
    {%- assign link_text1 = block.settings.link_text1 -%}
    {%- assign link_url1 = block.settings.link_url1 -%}
    {%- assign link_text2 = block.settings.link_text2 -%}
    {%- assign link_url2 = block.settings.link_url2 -%}

    {%- if block.settings.api_key == blank  -%}
      {%- if block.settings.map_image  %}
        {%- assign use_image = true -%}
      {%- else -%}
        {%- assign onboarding = true -%}
      {%- endif -%}
    {%- endif -%}

    {%- if block.settings.api_key != blank and block.settings.map_address -%}
      {%- assign display_map = true -%}
    {%- endif -%}

    <div class="map color--{{ section_color }}-text bg--{{ section_color }}-background" data-section-type="map" data-section-id="{{ block.id }}">
      <div class="lg--up--grid">
        <div class="lg--up--grid__item lg--up--one-half">
          <div class="relative px2 lg--up--px0 ">
            {% if onboarding == true %}
              <div class="bg--{{ section_color }}-placeholder">
                {{ 'lifestyle-2' | placeholder_svg_tag }}
              </div>
            {% endif %}
            {% if use_image %}
              {% render 'responsive-image' with
                image: map_image,
                max_width: 618,
                max_height: 517,
                section_color: section_color,
              %}
            {% endif %}
            {% if display_map %}
            <div class="map-wrapper">
              <div class="map-section__container"
                  id="Map-{{ block.id }}"
                  data-map
                  data-address-setting="{{ block.settings.map_address | escape }}"
                  data-api-key="{{ block.settings.api_key }}">
              </div>
            </div>
            {% endif %}
          </div>
        </div>
        <div class="lg--up--grid__item lg--up--one-half">
          <div class="px2 pt2 lg--up--px0 map__content">

            {% if block.settings.title == blank %}
              <h2 class="map__content--heading">{{ 'homepage.onboarding.collection_title' | t }}</h2>
            {% else %}
              <h2 class="map__content--heading">{{ block.settings.title }}</h2>
            {% endif %}

            {% unless block.settings.description == blank %}
              <div class="richtext line-height--3 font-size__basic map__content--description">
                {{ block.settings.description }}
              </div>
            {% endunless %}

            <div class="image-text-buttons_buttons">
              {% if link_url1 != blank %}
                <a class="mt1 inline-block font-size__basic f--accent aw-btn--tertiary" href="{{ link_url1 }}" target="_blank" aria-label="link - new window">
                  {{ link_text1 }}
                </a>
              {% endif %}
              {% if link_url2 != blank %}
                <a class="mt1 inline-block font-size__basic f--accent aw-btn--tertiary" href="{{ link_url2 }}" target="_blank" aria-label="link - new window">
                  {{ link_text2 }}
                </a>
              {% endif %}
            </div>

          </div>
        </div>
      </div>
    </div>

    {% endif %}

    {% if block.type == 'two_columns_text' %}

    {%- assign section_color = block.settings.color_scheme -%}

    {% assign text_column_count_numbers = "1, 2, 3, 4, 5, 6, 7, 8" | split: ", " %}

    <div class="aw-two-cols-text color--{{ section_color }}-text" data-section-type="richtext" data-section-id="{{ block.id }}">
      <div class="aw-two-cols-text__wrapper mx--auto">
        {% if block.settings.title  %}
          <h2 class="f--heading font-size--xl-bump lg--up--font-size--xxxxxxl mb3">{{ block.settings.title }}</h2>
        {% endif %}

        <div class="grid">

          {% for text_column_count_number in text_column_count_numbers %}

          {%- comment -%}Title{%- endcomment -%}
          {% assign item_title = 'item_title_%1' | replace:'%1', text_column_count_number %}
          {% assign item_title = block.settings[item_title] %}

          {%- comment -%}Richtext{%- endcomment -%}
          {% assign item_richtext = 'richtext_%1' | replace:'%1', text_column_count_number %}
          {% assign item_richtext = block.settings[item_richtext] %}

          {%- comment -%}Item price{%- endcomment -%}
          {% assign item_price = 'item_price_%1' | replace:'%1', text_column_count_number %}
          {% assign item_price = block.settings[item_price] %}


          <div class="grid__item md--up--one-half font-size__basic">
            <h2 class="font-size--l-bump mb1 headline-blue">{{ item_title }}</h2>

            {{ item_richtext }}

            {% if item_price != blank %}
            <div class="mb2 dark-gray text-align--right aw-text--sky-blue mr2">${{ item_price }}</div>
            {% endif %}
          </div> 

          {% endfor %}

        </div>

        {% if block.settings.cta_url %}
          <div class="flex justify--center aw-two-cols-text__button">
            <a class="inline-block aw-btn--navy text-inherit font-size__basic " href="{{ block.settings.cta_url }}" >
              {{ block.settings.cta_text }}
            </a>
          </div>
        {% endif %}

      </div>
    </div>

    {% endif %}

    {% if block.type == 'product_checker' %}

      {% render 'aw-product-checker' with
      title : block.settings.title,
      description: block.settings.description,
      copyright_text: block.settings.copyright_text,
      popup_title: block.settings.popup_title,
      popup_text: block.settings.popup_text %}

    {% endif %}

    {% if is_cascading_content_active == true and cascading_items_counter >= 0 %}

    {%- assign last_block_width_desktop = block_width_desktop -%}
    {%- assign last_block_width_mobile = block_width_mobile -%}

    {%- if block_width_desktop == 'half' -%}
      {%- assign col_count_desktop = col_count_desktop | plus: 1 -%}
    {% endif %}

    {%- if block_width_mobile == 'half' -%}
      {%- assign col_count_mobile = col_count_mobile | plus: 1 -%}
    {% endif %}

    {%- if col_count_desktop == 5 -%}
      {%- assign col_count_desktop = 1 -%}
    {%- endif -%}

    {%- if col_count_mobile == 5 -%}
      {%- assign col_count_mobile = 1 -%}
    {%- endif -%}

    </div>
  </div>
    {% endif %}

    {% if block.type == 'end_cascading_section' %}
      {% assign is_cascading_content_active = false %}
          </div>
        </div>
      </div>
    </div>

    {% elsif is_cascading_content_active != true %}
      </div><!-- Closes Background tag-->
    </div> <!-- Closes max-width tag -->
    {% endif %}

    {%- comment -%} Counter placed at the bottom so it doesn't count an extra time before the is_cascading_content_active gets set to false{%- endcomment -%}
    {% if is_cascading_content_active %}
      {% assign cascading_items_counter = cascading_items_counter | plus : 1 %}
    {% endif %}

    {%- endfor -%}

</section>
